{% block body %}
    <div class="card">

        <div>
            <img src="{{ asset(img_enterprises ~ offer.enterprise.imageName) }}" class="w-1/4 float-right"
                 alt="logo de l'entreprise">
            <h2 class="text-xl font-semibold text-gray-800 mb-4"> {{ offer.name }}</h2>
            <div class="mb-4">
                <div class="pill-holder">
                    {% for tag in offer.tags %}
                        <span class="pill">{{ tag.tag }}</span>
                    {% endfor %}
                </div>
                <p class="text-sm font-medium text-gray-500">
                    Il y a {{ offer.candidacies|length }} candidature(s) pour cette offre.
                    <br>
                    {% if offer.candidacies|length != 0 and "ROLE_ENTERPRISE" in app.user.roles
                        and offer.enterprise.user.id == app.user.id %}
                        <span>
                            <a href="{{ path('app_enterprise_offers_candidacies', { 'id': offer.id }) }}"
                               class="hover:underline">
                                Voir les candidatures.
                            </a>
                        </span>
                    {% endif %}
                </p>
            </div>
            <div class="mb-4">
                <p class="text-style-3lines">
                    {{ offer.description }}
                </p>
            </div>
        </div>

        <div class="link-container m-0">
            <div class="link-holder m-0">
                <div class="flex items-center justify-evenly w-full"><a
                            href="{{ path('app_offers_show', {'id': offer.id}) }}"
                            class="rounded-md p-2 text-white bg-blue-500 hover:bg-blue-600">En savoir +</a>
                    {% if app.user %}
                        {% if "ROLE_STUDENT" in app.user.roles %}
                            {% set find = false %}
                            {% for candidacy in offer.candidacies %}
                                {% if candidacy.student.user.id == app.user.id %}
                                    {% set find = true %}
                                {% endif %}
                            {% endfor %}
                            {% if find %}
                                <a href="{{ path('app_delete_candidacy', { 'id': offer.id }) }}"
                                   class="btn bg-red-500 hover:bg-red-600">DÃ©sister</a>
                            {% else %}
                                <a href="{{ path('app_new_candidacy', { 'id': offer.id }) }}"
                                   class="btn bg-sky-500 hover:bg-sky-600">Postuler</a>
                            {% endif %}
                            {% if offer.candidacies %}
                                {% for candidacy in offer.candidacies %}
                                    {% if candidacy.student.user.id == app.user.id %}
                                        <span class="rounded-full text-sm p-2 text-white bg-{{ candidacy.status }}">
                                            {{ candidacy.status }}
                                        </span>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        {% elseif "ROLE_ENTERPRISE" in app.user.roles %}
                            {% if offer.enterprise.id == app.user.enterprise.id %}
                                <a href="{{ path("app_offers_edit", {'id': offer.id}) }}"
                                   class="rounded-md p-2 text-white bg-blue-500 hover:bg-blue-600">Modifier</a>
                                {{ include('offers/_delete_form.html.twig') }}
                            {% endif %}
                            <span class="rounded-full text-sm p-2 text-white bg-{{ offer.status }}">{{ offer.status }}</span>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>

    </div>
{% endblock %}